# 智能家居控制面板 (Lamp-Win)

## 项目概述

这是一个基于Qt 5.12开发的智能家居控制面板，集成了离线语音识别、实时天气查询、MQTT设备控制等功能。项目采用现代化的深色主题UI设计，提供直观的设备控制和环境监控界面。

## 🌟 主要功能

### 🎤 离线语音控制
- **Vosk语音识别引擎**：支持中文离线语音识别
- **智能语音命令**：开灯、关灯、风扇控制、蜂鸣器、门锁等
- **实时语音反馈**：显示识别结果和命令执行状态
- **多设备支持**：支持控制多个LED灯（LED1、LED2、LED3）

### 🌤️ 实时天气信息
- **深色主题天气卡片**：现代化的渐变背景设计
- **完整天气数据**：温度、湿度、气压、风速、体感温度等
- **动态空气质量**：根据API数据智能显示空气质量信息
- **自动更新**：支持语音命令查询天气

### 🏠 智能设备控制
- **LED灯光控制**：3个独立LED灯控制
- **风扇控制**：智能风扇开关
- **蜂鸣器控制**：报警器控制
- **门锁控制**：智能门锁开关
- **状态同步**：实时显示设备开关状态

### 📊 环境传感器监控
- **温度监控**：实时显示环境温度
- **湿度监控**：实时显示环境湿度
- **光照监控**：实时显示光照强度
- **人体感应**：检测人体红外信号

### 🔗 MQTT通信
- **实时通信**：基于MQTT协议的设备通信
- **双向数据流**：支持设备状态上报和控制指令下发
- **可配置服务器**：支持自定义MQTT服务器地址和主题

## 🛠️ 技术架构

### 核心技术栈
- **Qt 5.12**：跨平台GUI框架
- **Vosk**：离线语音识别引擎
- **MQTT**：物联网通信协议
- **HTTP API**：天气数据获取
- **OpenBLAS**：数学计算库

### 音频处理
- **采样率**：16kHz
- **声道**：单声道
- **位深度**：16bit
- **格式**：PCM

## 📦 安装说明

### 系统要求
- Windows 10/11
- Qt 5.12 或更高版本
- 支持音频输入的设备

### 依赖安装

#### 1. Vosk中文语音模型
```bash
# 创建模型目录
mkdir models
cd models

# 下载中文模型
wget https://alphacephei.com/vosk/models/vosk-model-cn-0.22.zip
unzip vosk-model-cn-0.22.zip
```

#### 2. OpenBLAS数学库
1. 下载OpenBLAS：https://github.com/xianyi/OpenBLAS/releases
2. 解压到合适位置
3. 在项目配置中更新OpenBLAS路径

#### 3. 项目依赖
- `libvosk.dll`：已包含在lib目录中
- Qt多媒体模块
- Qt网络模块
- Qt MQTT模块

### 编译步骤
1. 使用Qt Creator 5.12打开 `lamp.pro` 文件
2. 配置项目依赖库路径
3. 编译项目
4. 运行应用程序

## 🎯 使用方法

### 基本操作
1. **启动应用**：运行编译后的可执行文件
2. **连接MQTT**：输入服务器地址和主题，点击"连接"
3. **设备控制**：点击对应按钮控制设备
4. **语音控制**：按住"按住说话"按钮，说出命令后松开

### 语音命令列表
| 命令 | 功能 | 示例 |
|------|------|------|
| 开灯 | 开启LED灯 | "开灯"、"打开灯" |
| 关灯 | 关闭LED灯 | "关灯"、"关闭灯" |
| 风扇 | 控制风扇 | "风扇"、"开风扇" |
| 蜂鸣器 | 控制蜂鸣器 | "蜂鸣器"、"报警" |
| 门锁 | 控制门锁 | "门锁"、"锁门" |
| 全部关闭 | 关闭所有设备 | "全部关闭"、"关闭所有" |
| 天气 | 查询天气 | "天气"、"查询天气" |

### 设备编号说明
- **LED1**：设备ID 0
- **LED2**：设备ID 1  
- **LED3**：设备ID 2
- **风扇**：设备ID 0
- **蜂鸣器**：设备ID 0
- **门锁**：设备ID 0

## 🎨 UI设计特色

### 深色主题
- **现代化设计**：深色渐变背景
- **色彩层次**：合理的颜色搭配和对比度
- **响应式布局**：自适应不同屏幕尺寸

### 天气显示
- **卡片式设计**：圆角边框和阴影效果
- **信息层次**：重要信息突出显示
- **动态内容**：根据API数据智能显示

### 设备控制
- **直观按钮**：清晰的开关状态显示
- **分组布局**：按功能分组排列
- **状态反馈**：实时显示设备状态

## 🔧 配置说明

### MQTT配置
```json
{
  "服务器": "mqtt.yyzlab.com.cn",
  "端口": "1883",
  "发布主题": "1752540016071/APP2AIOTSIM",
  "订阅主题": "1752540016071/AIOTSIM2APP"
}
```

### 天气API配置
- **API地址**：http://124.222.204.22/api/tianqi/tqyb.php
- **地区**：四川绵阳
- **更新频率**：手动查询或语音触发

## 🐛 故障排除

### 常见问题

#### 语音识别问题
- **模型加载失败**：检查模型路径是否正确
- **识别效果差**：确保在安静环境中使用
- **音频设备错误**：检查麦克风权限和驱动

#### 网络连接问题
- **MQTT连接失败**：检查服务器地址和网络连接
- **天气查询失败**：检查网络连接和API状态

#### 编译问题
- **依赖库缺失**：确保所有依赖库已正确安装
- **路径配置错误**：检查项目配置文件中的库路径

### 调试信息
- 查看控制台输出的调试信息
- 检查MQTT消息的发送和接收
- 监控语音识别的识别结果

## 📝 更新日志

### v2.0.0 (最新)
- ✅ 集成Vosk离线语音识别
- ✅ 优化天气显示界面
- ✅ 实现深色主题设计
- ✅ 添加空气质量动态显示
- ✅ 优化UI布局和响应式设计
- ✅ 修复语音控制逻辑问题
- ✅ 移除不必要的UI元素

### v1.0.0
- ✅ 基础MQTT设备控制
- ✅ 实时天气查询
- ✅ 环境传感器监控
- ✅ 基础UI界面

## 🤝 贡献指南

欢迎提交Issue和Pull Request来改进项目！

### 开发环境
- Qt Creator 5.12
- Windows 10/11
- Git版本控制

### 代码规范
- 遵循Qt编码规范
- 添加适当的注释
- 保持代码整洁和可读性

## 📄 许可证

本项目采用MIT许可证，详见LICENSE文件。

## 📞 联系方式

如有问题或建议，请通过以下方式联系：
- 提交okraj@qq.comokraj@qq.com
- 发送邮件至项目维护者

---

**智能家居控制面板** - 让生活更智能，让控制更简单！ 🏠✨ 